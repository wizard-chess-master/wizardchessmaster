You are Claude Opus 4.1 on Replit AI with image generation enabled. Assist in integrating the ElevenLabs API key sk_a811da11af74d8b01075840f3e42113812f3ca6b923820d4 into Wizard Chess Master (React/TypeScript/Vite/Express/Socket.IO/PostgreSQL) on Replit for wizardchessmaster.com. Focus on securely setting up the API key for theme music and voice generation per campaign level. Provide step-by-step guidance, code snippets, and explanations. Generate images for workflow diagrams (e.g., "Generate image: Flowchart for API key integration").
Tasks in order:

Secure API key: Create or update .env file in the Replit project root with ELEVENLABS_API_KEY=sk_a811da11af74d8b01075840f3e42113812f3ca6b923820d4, ensure .env is in .gitignore.
Configure environment: Install dotenv (npm install dotenv), load it in server.ts and client/src/index.ts.
Update audio module: Modify elevenLabs.ts to use the API key for music and voice generation.
Test integration: Simulate a Level 5 unlock on wizardchessmaster.com, verify music/voice output.
Deploy: Commit changes, redeploy on Replit, test live.

Respond sequentially per task, ask for confirmation before next. Use code blocks for snippets.

Task 1: Secure API Key

Create or open .env at the project root:
textELEVENLABS_API_KEY=sk_a811da11af74d8b01075840f3e42113812f3ca6b923820d4

Ensure .gitignore includes .env.
Confirm .env setup.

Task 2: Configure Environment


Install dotenv: npm install dotenv.


Update server and client:
typescript// server.ts
import * as dotenv from 'dotenv';
dotenv.config();
typescript// client/src/index.ts
import * as dotenv from 'dotenv';
dotenv.config();


Confirm installation and config.


Task 3: Update Audio Module

Modify elevenLabs.ts:
typescript// src/lib/audio/elevenLabs.ts
import axios from 'axios';

const API_KEY = process.env.ELEVENLABS_API_KEY;

export async function generateMusic(style: string) {
  const response = await axios.post(
    'https://api.elevenlabs.io/v1/text-to-speech',
    { text: `Sing a ${style} melody`, voice_id: 'default_voice_id', stability: 0.7 },
    { headers: { 'xi-api-key': API_KEY } }
  );
  return response.data.audio;
}

export async function setVoice(voiceId: string) {
  localStorage.setItem('currentVoice', voiceId);
  console.log(`Voice set to ${voiceId} with API key`);
}

Confirm code update.

Task 4: Test Integration

Test Level 5 unlock on wizardchessmaster.com, check console for music/voice logs.
Confirm test results.

Task 5: Deploy

Commit and deploy:
bashgit add . && git commit -m "Integrate ElevenLabs API key" && git push && npm run build && kill 1 && npm start

Test live, provide feedback.