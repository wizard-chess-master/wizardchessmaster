<!DOCTYPE html>
<html>
<head>
    <title>Multiplayer Frontend Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <h1>Wizard Chess Multiplayer Test</h1>
    <div id="status">Connecting...</div>
    <div id="log"></div>
    
    <script>
        const log = document.getElementById('log');
        const status = document.getElementById('status');
        
        function addLog(message) {
            const div = document.createElement('div');
            div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.appendChild(div);
            console.log(message);
        }
        
        // Test Socket.IO connection
        const socket = io('http://localhost:5000', {
            transports: ['polling', 'websocket']
        });
        
        socket.on('connect', () => {
            status.textContent = 'Connected âœ…';
            addLog('âœ… Connected to server: ' + socket.id);
            
            // Test player join
            socket.emit('player:join', {
                userId: 2001,
                username: 'FrontendTestPlayer',
                displayName: 'Frontend Test Player',
                rating: 1300
            });
        });
        
        socket.on('player:joined', (response) => {
            addLog('âœ… Player joined: ' + JSON.stringify(response));
            
            // Test matchmaking
            socket.emit('matchmaking:join', { timeControl: 600 });
            addLog('ğŸ¯ Joining matchmaking...');
        });
        
        socket.on('matchmaking:joined', (data) => {
            addLog('âœ… Matchmaking joined: ' + JSON.stringify(data));
        });
        
        socket.on('game:matched', (gameData) => {
            addLog('ğŸ® Game matched! ' + JSON.stringify(gameData));
        });
        
        socket.on('connect_error', (error) => {
            status.textContent = 'Connection Error âŒ';
            addLog('âŒ Connection error: ' + error.message);
        });
        
        socket.on('disconnect', () => {
            status.textContent = 'Disconnected';
            addLog('ğŸ”Œ Disconnected from server');
        });
        
        // Test API endpoints
        fetch('/api/multiplayer/stats')
            .then(res => res.json())
            .then(data => addLog('ğŸ“Š Server stats: ' + JSON.stringify(data)))
            .catch(err => addLog('âŒ Stats fetch error: ' + err.message));
            
        fetch('/api/multiplayer/leaderboard')
            .then(res => res.json())
            .then(data => addLog('ğŸ† Leaderboard: ' + JSON.stringify(data)))
            .catch(err => addLog('âŒ Leaderboard fetch error: ' + err.message));
    </script>
</body>
</html>